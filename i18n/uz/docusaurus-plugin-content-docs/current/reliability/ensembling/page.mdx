---
sidebar_position: 5
title: "ðŸŸ¡ Prompt ansambl qilish"
---


# Promptlarni ansambl qilish

Prompt ensembling â€” bu bir nechta turli promptlardan foydalanish orqali harakat qilish tushunchasidir
Xuddi shu savolga javob bering. Buning uchun turli xil yondashuvlar mavjud.

## DiVeRSe

DiVeRSe(@li2022advance) ("**Di**verse **Ve**rifier on **R**easoning **S**t**e**ps") bu
javoblarning ishonchliligini uch yoâ€˜nalishda oshiradigan usul. Bu quyidagilar orqali amalga oshiriladi

1) bir nechta promptlardan foydalanib, turli xil yakunlarni yaratish,
2) yaxshi javoblarni yomon javoblardan ajratish uchun tekshiruvchi vositasidan foydalanish, va
3) mulohaza yuritish bosqichlarining toâ€˜gâ€˜riligini tekshirish uchun tekshiruvchi foydalanish.

<div style={{ textAlign: "center" }}>
  <Image
    src="/docs/assets/reliability/diverse.webp"
    width={824}
    height={300}
    style={{ width: "750px", margin: "auto" }}
  />
</div>

<div style={{ textAlign: "center" }}>DiVeRSe (Li et al.)</div>

### Turli xil Promptlar

DiVeRSe berilgan kirish uchun 5 xil promptdan foydalanadi. Har bir promptni yaratish uchun ular tasodifiy
oâ€˜quv toâ€˜plamidan bir nechta namunalarni tanlang. Quyida shunday few-shot namunalaridan biri keltirilgan
prompt (k=2), namunalar [GSM8K benchmark](https://raw.githubusercontent.com/openai/grade-school-math/master/grade_school_math/data/train.jsonl)(@cobbe2021training) dan olingan. Amalda, DiVeRSe foydalanadi
Ushbu benchmark uchun promptlarda 5 ta namunalar.

```
Q: Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
A: Natalia sold 48/2 = 24 clips in May.
Natalia sold 48+24 = 72 clips altogether in April and May.
#### 72
Q: Weng earns $12 an hour for babysitting. Yesterday, she just did 50 minutes of babysitting. How much did she earn?
A: Weng earns 12/60 = $0.2 per minute.
Working 50 minutes, she earned 0.2 x 50 = $10.
#### 10
Q: Betty is saving money for a new wallet which costs $100. Betty has only half of the money she needs. Her parents decided to give her $15 for that purpose, and her grandparents twice as much as her parents. How much more money does Betty need to buy the wallet?
A:
```

Yuqoridagi kabi 5 ta turli promptlar yaratilgandan soâ€˜ng, DiVeRSe 20 ta mulohaza yoâ€˜llarini tanlab oladi
har bir (temperature = 0.5) uchun. Quyida yuqoridagi prompt uchun bir nechta namunaviy yakunlar keltirilgan.
E'tibor bering, javoblar har doim ham to'g'ri bo'lmasligi mumkin.

```text {1-5}
Bettyda 0.5*100 = $50 bor.
Keyin u yana 15 ta oladi = $65.
Keyin u 2*15 = $90 oladi.
Unga yana 100-90 = $10 kerak.
#### 10
```

```text {1-5}
A: Bettyda 0.5*100 = $500 bor.
Keyin u yana 15 ta oladi = $650.
Keyin u 2*15 = $900 oladi.
Unga yana 100-90 = $1000 kerak.
#### 1000
```

Bu bosqichda, DiVeRSe 100 ta turli yakunlarni yaratdi.

### Ovoz berishni tasdiqlovchi

Endi biz shunchaki koâ€˜pchilik javobini olishimiz mumkin, xuddi Self-Consistency(@mitchell2022enhancing) qilgani kabi.

Biroq, DiVeRSe ancha murakkabroq usulni taklif qiladi, uni ular _voting verifier_ deb atashadi.

Sinov vaqtida, voting verifier dan foydalanish ikki bosqichli jarayondir. Avvalo, verifier (neyron tarmoq)
har bir yakun uchun toâ€˜gâ€˜ri boâ€˜lish ehtimoliga qarab 0-1 ball beradi. Keyin, 'ovoz berish'
komponent turli javoblar boâ€˜yicha barcha ballarni yigâ€˜adi va yakuniy javobni beradi.

#### Misol

Mana kichik bir misol. Tasavvur qiling, bizda quyidagi javoblar mavjud: prompt `What is two plus two?` uchun:

```text {1-1}
4
```

```text {1-1}
ikki + 2 = 5
```

```text {1-1}
Menimcha, 2+2 = 6
```

```text {1-1}
ikki qoâ€˜shilgan ikki = 4
```

```text {1-1}
Bu 5
```

Verifikator har bir yakuniy natijani oâ€˜qib chiqadi va unga ball beradi. Masalan, u quyidagicha ball berishi mumkin
ballar: 0.9, 0.1, 0.2, 0.8, 0.3 mos ravishda. Keyin, ovoz berish komponenti har birining ballarini qoâ€˜shadi
answer.

```
score(4) = 0.9 + 0.8 = 1.7
score(5) = 0.1 + 0.3 = 0.4
score(6) = 0.2
```

Yakuniy javob 4, chunki u eng yuqori ballga ega.

**Lekin verifikator qanday oâ€˜qitiladi?**

Verifier biroz murakkabroq yoâ€˜qotish funksiyasi bilan oâ€˜qitiladi, bu
Men bu yerda yoritmayman. Batafsil maâ€™lumot uchun maqolaning 3.3-boâ€˜limini oâ€˜qing (@li2022advance).

## Menga istalgan savolni bering (AMA) Prompting

<div style={{ textAlign: "center" }}>
  <Image
    src="/docs/assets/reliability/AMA_Prompting.webp"
    width={1313}
    height={469}
    style={{ width: "750px", margin: "auto" }}
  />
</div>

Ask Me Anything (AMA) prompting(@arora2022ama) DiVeRSe ga oâ€˜xshash yondashuv hisoblanadi. Biroq, uning bir nechta prompt yaratish bosqichi va javoblarni birlashtirish bosqichi sezilarli darajada farq qiladi. AMA ning asosiy gâ€˜oyasi shundaki, bir nechta few-shot namunalaridan foydalanish oâ€˜rniga, bir nechta promptlarni yaratish uchun LLM dan foydalaniladi.

### Bir nechta Promptlar

AMA shuni koâ€˜rsatadiki, siz savolni olib, uni bir nechta usullarda qayta formatlab, turli promptlar yaratishingiz mumkin. Masalan, siz hayvonlar haqidagi maâ€™lumotlarni bir qancha veb-saytlardan yigâ€˜ayotgan boâ€˜lsangiz va faqat Shimoliy Amerikada yashaydiganlarini yozib olishni istasangiz. Keling, buni aniqlash uchun prompt tuzamiz.

Quyidagi Wikipedia parchasiga asoslanib:

```text
Kermode ayiÄŸi, baâ€™zan ruh ayiÄŸi deb ham ataladi (Ursus americanus kermodei), Amerika qora ayiÄŸinin kichik turi boâ€˜lib, Kanada, Britaniya Kolumbiyasining Markaziy va Shimoliy sohil hududlarida yashaydi.
```

Siz bu vazifani quyidagicha promptga formatlashingiz mumkin:

```text
Quyidagi da'vo kontekstga koâ€˜ra Toâ€˜gâ€˜ri yoki Notoâ€˜gâ€˜ri ekanligini aniqlang.

Kermode ayiÄŸi, baâ€™zan ruh ayiÄŸi deb ham ataladi (Ursus americanus kermodei), Amerika qora ayiÄŸi ning kichik turi boâ€˜lib, Kanada ning Britaniya Kolumbiyasi markaziy va shimoliy sohil hududlarida yashaydi.
Daâ€™vo: Bu hayvon Shimoliy Amerikada yashaydi
Javob:
```

Bu biroz gâ€˜alati ifoda. Nega shunchaki quyidagi oddiyroq promptdan foydalanmaslik kerak?

```text
Kermode ayiÄŸi, baâ€™zan spirit bear deb ham ataladi (Ursus americanus kermodei), Amerika qora ayiÄŸi ning kichik turi boâ€˜lib, Kanada ning Britaniya Kolumbiyasi markaziy va shimoliy sohil hududlarida yashaydi.
Savol: Bu hayvon Shimoliy Amerikada yashaydimi?
```

Xoâ€˜sh, savolni shu maxsus tarzda shakllantirish orqali biz turli promptlarni yaratishimiz mumkin.
Bu yerda birinchi qadamingiz `This animal lives in North America` da'vosini olib, uni turli savollarga qayta formatlash bo'ladi, ular asosan bir xil narsani so'ramoqda. Buni amalga oshirish uchun, biz da'voni quyidagi rasmda ko'rsatilgan promptlar orqali o'tkazamiz.

<div style={{ textAlign: "center" }}>
  <Image
    src="/docs/assets/reliability/AMA_multiprompting.webp"
    width={1778}
    height={416}
    style={{ width: "800px", margin: "auto" }}
  />
</div>

Bu quyidagicha natija berishi mumkin:

1. Hayvon Shimoliy Amerikada yashaganmi?
2. Hayvon Shimoliy Amerikada yashaydimi?
3. Hayvon qayerda yashaydi?

Buning orqasidagi gâ€˜oya â€” vazifaning turli _koâ€˜rinishlari_ni yaratishdir. Soâ€˜ngra har birini quyidagicha berilgan kontekstga qoâ€˜llaymiz:

```text
Kermode ayiÄŸi, baâ€™zan ruh ayiÄŸi deb ham ataladi (Ursus americanus kermodei), Amerika qora ayiÄŸining kichik turi boâ€˜lib, Kanadaning Britaniya Kolumbiyasi markaziy va shimoliy sohil hududlarida yashaydi.
Savol: Hayvon Shimoliy Amerikada yashaganmi?
```

Keyin, biz har biri uchun javoblar yaratishimiz mumkin:

1. `Yes it was`
2. `Yes it does`
3. Shimoliy Amerika

Bular _oraliq_ javoblardir. Biz ularni vazifa yorliqlariga (masalan, Ha yoki Yoâ€˜q) moslashtirishimiz kerak.

Buni biz oraliq javoblarni quyidagidek prompt orqali uzatish orqali amalga oshirishimiz mumkin:

```text
Toâ€˜gâ€˜ri toifani tanlang.

"Kategoriyalar":
- Ha, Shimoliy Amerika
- Yoâ€˜q, Shimoliy Amerika emas

"Ha, bu shunday" quyidagi toifaga mos keladi:
```

Endi biz natijaviy javoblarimizni olamiz.

1. Ha, Shimoliy Amerika
2. Ha, Shimoliy Amerika
3. Ha, Shimoliy Amerika

Bu yerda, ular barchasi rozi, shuning uchun biz shunchaki birinchi javobni olamiz. Biroq, agar ular rozi boâ€˜lmaganida, yakuniy javob olish uchun AMA agregatsiya bosqichidan foydalanishimiz mumkin edi.

### Javoblarni yigâ€˜ish

AMA javoblarni yigâ€˜ishda (DiVeRSeâ€™dan ham murakkabroq) juda murakkab strategiyadan foydalanadi, faqat koâ€˜pchilik javobini olish oâ€˜rniga. Nega koâ€˜pchilik javobi yomon tanlov boâ€˜lishi mumkinligini tushunish uchun, avval yaratgan ikki savolimizni koâ€˜rib chiqing:

1. Hayvon Shimoliy Amerikada yashaganmi?
2. Hayvon Shimoliy Amerikada yashaydimi?

Ular juda oâ€˜xshash, shuning uchun ehtimol bir xil natija hosil qiladi. Savollar juda oâ€˜xshash boâ€˜lgani uchun, ular yakuniy natijaga taâ€™sir koâ€˜rsatadi. Buni hal qilish uchun, AMA zaif nazorat va murakkab matematikaga tayanadi, u yaratgan turli promptlar oâ€˜rtasidagi bogâ€˜liqliklarni baholaydi va keyin ularni mos ravishda ogâ€˜irlik bilan baholaydi.

Shunday qilib, biz yaratgan uchta savol uchun u 25%, 25% va 50% ogâ€˜irliklarni belgilashi mumkin, chunki birinchi ikkisi juda oâ€˜xshash.

AMA ning agregatsiya strategiyasi kuchli boâ€˜lsa-da, u shunchalik murakkabki, bu yerda uni yoritmayman. Batafsil maâ€™lumot uchun maqolaning 3.4-boâ€˜limini oâ€˜qing (@arora2022ama).

### Natijalar

- Ushbu prompting strategiyasi yordamida AMA GPT-J-6B(@wange2021gptj) dan foydalanib, GPT-3 dan yaxshiroq natijalarga erisha oladi.

- AMA berilgan kontekstda javob mavjud boâ€˜lgan savollarda yaxshiroq ishlaydi.

## Xulosalar

Ansambl usullari juda kuchli. Ular har qanday modelning samaradorligini oshirish uchun ishlatilishi mumkin va modelning maâ€™lum bir vazifadagi samaradorligini oshirish uchun ham qoâ€˜llanilishi mumkin.

Amaliyotda, koâ€˜pchilik ovozi sizning asosiy strategiyangiz boâ€˜lishi kerak.
